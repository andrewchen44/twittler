<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel="stylesheet" href="main.css">
  </head>
  <body>
    <script>

      $(document).ready(function(){
        var shawndrost = [];
        var sharksforcheap = [];
        var mracus = [];
        var douglascalhoun = [];

        var $body = $('body');
        $body.html('');
        //get time function
        var getTime = function(){
          var n = new Date();
    	  var hours = n.getHours().toString();
    	  var minutes = n.getMinutes();
    	  var dight = ':am ';
    	if(hours > 11){
    		dight = ':pm ';
    	}
    	if(hours > 12){
    		hours = hours - 12;
    	} 
    	if(hours === 0){
    		hours = hours + 12;
    	}
    	if(minutes < 10){
    		minutes = '0' + minutes.toString();
    	} else{
    		minutes.toString();
    	}
    	  var time = hours + ':' + minutes + ' ' + dight;
         return time;
        }

        //to add a title to the page
        var $title = $('<p>Twittler </p>');
        $title.appendTo($body);

        //to tweet out all that are available
        var index = streams.home.length - 1;
        while(index >= 0){
          var tweet = streams.home[index];
          var $tweet = $('<div></div>');
          tweet.time = getTime();
          var $currentUser = $('<button class ="user"></button>');
          $currentUser.text('@' + tweet.user);
          $currentUser.attr('id',tweet.user);

          $tweet.text(tweet.message + ' at ' + tweet.time);
          $tweet.appendTo($body);
          $currentUser.appendTo($tweet);
          if(tweet.user === 'shawndrost'){
          	shawndrost.push(tweet.message + ' at ' + tweet.time + '@' + tweet.user);
          } else if(tweet.user === 'sharksforcheap'){
          	sharksforcheap.push(tweet.message + ' at ' + tweet.time + '@' + tweet.user);
          } else if (tweet.user === 'douglascalhoun'){
          	douglascalhoun.push(tweet.message + ' at ' + tweet.time + '@' + tweet.user);
          } else {
            mracus.push(tweet.message + ' at ' + tweet.time + '@' + tweet.user);
          }
          index -= 1;
        }	

        //button to load new tweets
        var $button = $('<button id = "loader"> Load A Newer Tweet! </button>');
        $button.appendTo($body);

        $("#loader").click(function(){
          var index = streams.home.length - 1;
          var newTweets = streams.home[streams.home.length - 1];
          var $newTweets = $('<div></div>');
          tweet.time = getTime();
          var $currentUser = $('<button class ="user"></button>');

          $currentUser.text('@' + newTweets.user);
          $currentUser.attr('id',newTweets.user);
          $newTweets.text( ': ' + newTweets.message + ' at '+ tweet.time);

         if(newTweets.user === 'shawndrost'){
          	shawndrost.push(newTweets.message + ' at ' + tweet.time + '@' + newTweets.user);
          } else if(newTweets.user === 'sharksforcheap'){
          	sharksforcheap.push(newTweets.message + ' at ' + tweet.time + '@' + newTweets.user);
          } else if (newTweets.user === 'douglascalhoun'){
          	douglascalhoun.push(newTweets.message + ' at ' + tweet.time + '@' + newTweets.user);
          } else {
            mracus.push(newTweets.message + ' at ' + tweet.time + '@' + newTweets.user);
          }

          $(this).before($newTweets);  
          $currentUser.appendTo($newTweets);



        });

        //To show user timelines
        $('.user').on('click', function(){
         var id = this.getAttribute('id');
         var old = [];

         if(id === 'shawndrost'){
         	old = shawndrost;
         } else if (id === 'sharksforcheap'){
         	old = sharksforcheap;
         } else if (id === 'douglascalhoun'){
         	old = douglascalhoun;
         } else {
         	old = mracus;
         }

          var index = old.length-1;
            while(index >= 0){
            	var oldTweet = old[index];
            	var $oldTweet = $('<div></div>');
            	$oldTweet.text(oldTweet);
            	$oldTweet.appendTo(this);

            	index--;
            }
          
        });

      });

    </script>


  </body>
</html>
